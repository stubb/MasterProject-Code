<!DOCTYPE html>
<html lang="en">
<head>
	<title>Remote control</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/themes/htw_color.css" />
	<link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="css/jquery.mobile.structure-1.4.5.min.css" />
	<link rel="stylesheet" href="css/client.css">
	<link href="css/toastr/toastr.min.css" rel="stylesheet"/>
	<script src="js/jquery/jquery-1.11.2.min.js"></script> 
	<script src="js/jquery/jquery.mobile-1.4.5.min.js"></script>
	<script src="js/helper.js"></script>
	<script src="js/config.js"></script>
	<script src="network-webrtc-adapter.js"></script>
	<script src="network-websocket-adapter.js"></script>
	<script src="network-facade.js"></script>
	<script src="js/toastr/toastr.min.js"></script>
	<script src="js/toastr/toastr_conf.js"></script>

	<script type="text/javascript">
		var nwF = new NetworkFacade(remote_server_protocol);
		nwF.init(remote_server_url, user);

		/**
		*	Fragt die Hoehe des Anzeigebereichs des Browsers ab, und gibt den
		*	Wert zurueck.
		*
		*	@return	Groesse der Hoehe des Anzeigebreichs in Pixel.
		*/
		function getDocHeight()
		{
			var height = window.innerHeight ||								// alle Browser
						(window.document.documentElement.clientHeight ||	// IE im Standard-Mode
						window.document.body.clientHeight);				// IE im Quirks-Mode
			return height;
		}

		/**
		*	Fragt die Breite des Anzeigebereichs des Browsers ab, und gibt den
		*	Wert zurueck.
		*
		*	@return	Groesse der Breite des Anzeigebreichs in Pixel.
		*/
		function getDocWidth()
		{
			var width = window.innerWidth ||                      			// alle Browser
						(window.document.documentElement.clientWidth ||     // IE im Standard-Mode
						window.document.body.clientWidth);					// IE im Quirks-Mode
			return width;
		}

		$(document).ready(function () {
			$('#content_container').append('<canvas id="canvasSignature" class="center" width="' + getDocWidth() * 0.9 + '" height="' + getDocHeight() * 0.9 + '">')
			var optimalSize = calcOptimalSize($('#content_container').outerWidth(), $('#content_container').outerHeight(), 1280, true);
			init($('#canvasSignature')[0], optimalSize[0], optimalSize[1], '#ddd');
		});

    function init(canvas, width, height, fillColor) {
        var ctx = canvas.getContext("2d");
        // define a custom fillCircle method
        ctx.fillCircle = function(x, y, radius, fillColor) {
            this.fillStyle = fillColor;
            this.beginPath();
            this.moveTo(x, y);
            this.arc(x, y, radius, 0, Math.PI * 2, false);
            this.fill();
        };
        ctx.clearTo = function(fillColor) {
            ctx.fillStyle = fillColor;
            ctx.fillRect(0, 0, width, height);
        };
        ctx.clearTo(fillColor || "#ddd");

        // bind mouse events
        canvas.onmousemove = function(e) {
            if (!canvas.isDrawing) {
               return;
            }
            var x = e.pageX - this.offsetLeft;
            var y = e.pageY - this.offsetTop;
            var radius = 4;
            var fillColor = '#ff0000';
            ctx.fillCircle(x, y, radius, fillColor);
        };
        canvas.onmousedown = function(e) {
            canvas.isDrawing = true;
        };
        canvas.onmouseup = function(e) {
            canvas.isDrawing = false;
			var _image_data = document.getElementById('canvasSignature').toDataURL("image/jpeg");
			_image_data = _image_data.replace(/^data:image\/jpeg;base64,/ig, "");
			sendPicture(document.getElementById('canvasSignature').width, document.getElementById('canvasSignature').height, _image_data, nwF);
        };
    }
   </script>
   
</head>
 
<body>
	<div id="content_container">
	</div>
</body>
</html>  
